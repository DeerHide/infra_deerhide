---

- name: Create minio directory
  ansible.builtin.file:
    path: /opt/minio/
    state: directory
    owner: deerhide-operator
    mode: '0755'
  become: true

- name: Found and register "arch"
  ansible.builtin.command:
    cmd: dpkg --print-architecture
  become: true
  register: cli_minio_arch
  changed_when: false

- name: Get MinioClient
  ansible.builtin.get_url:
    url: https://dl.min.io/client/mc/release/linux-{{ cli_minio_arch.stdout }}/mc
    dest: /opt/minio/
    owner: deerhide-operator
    mode: '0755'
  become: true

- name: Link mc to /usr/local/bin
  ansible.builtin.file:
    src: /opt/minio/mc
    dest: /usr/local/bin/mc
    state: link
  become: true

- name: Check MinioClient version
  ansible.builtin.command:
    cmd: /usr/local/bin/mc --version
  become: true
  changed_when: false
