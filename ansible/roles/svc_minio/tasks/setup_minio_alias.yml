---
# code: language=ansible
# Path: ansible/roles/svc_minio/tasks/setup_minio_alias.yml
# This file contains the tasks to create deerhide-operator alias for Minio

- name: Check and create alias if needed
  block:
    - name: Check if bunryl alias exists
      ansible.builtin.command:
        cmd: /usr/local/bin/mc alias list
      changed_when: false
      register: minio_alias_list

    - name: Create alias 'bunryl' if it doesn't exist
      ansible.builtin.command:
        cmd: /usr/local/bin/mc alias set bunryl http://192.168.3.220:9000 {{ bunryl_minio_root_user }} {{ bunryl_minio_root_password }}
      changed_when: true
      when: minio_alias_list.stdout.find('bunryl') == -1
